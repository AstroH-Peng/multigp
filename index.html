<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>multigp by SheffieldML</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">multigp</h1>
      <h2 class="project-tagline">Multiple output Gaussian processes in MATLAB including the latent force model.</h2>
      <a href="https://github.com/SheffieldML/multigp" class="btn">View on GitHub</a>
      <a href="https://github.com/SheffieldML/multigp/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/SheffieldML/multigp/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="multi-output-gaussian-processes---matlab-software" class="anchor" href="#multi-output-gaussian-processes---matlab-software" aria-hidden="true"><span class="octicon octicon-link"></span></a>Multi-output Gaussian Processes - MATLAB Software</h1>

<p>Multiple output Gaussian processes in MATLAB including the latent force model.</p>

<p>This page describes examples of how to use the Multi-output Gaussian Process Software (MULTIGP).</p>

<p>This software depends on the <a href="https://github.com/SheffieldML/GPmat">GPmat repository software</a>.</p>

<h3>
<a id="old-release-numbers" class="anchor" href="#old-release-numbers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Old Release Numbers</h3>

<p>Contains updates to the code for the technical report.</p>

<h4>
<a id="version-011" class="anchor" href="#version-011" aria-hidden="true"><span class="octicon octicon-link"></span></a>Version 0.11</h4>

<p>Updates to allow variational outputs for working with latent functions</p>

<p>that are white noise processes.</p>

<h4>
<a id="version-01" class="anchor" href="#version-01" aria-hidden="true"><span class="octicon octicon-link"></span></a>Version 0.1</h4>

<p>This is the very first version of the multi-ouput Gaussian Process
toolbox. It shows toy examples for a full covariance model and two
approximations proposed in the paper Sparse
Convolved Gaussian Processes for Multi-ouput regression</p>

<h2>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h2>

<h3>
<a id="multi-output-gaussian-process-using-a-gaussian-kernel-and-a-gaussian-covariance-function" class="anchor" href="#multi-output-gaussian-process-using-a-gaussian-kernel-and-a-gaussian-covariance-function" aria-hidden="true"><span class="octicon octicon-link"></span></a>Multi-output Gaussian process using a Gaussian kernel and a Gaussian covariance function</h3>

<p>This example shows how it is possible to make multiple regression
over four outputs using a Gaussian process constructed with the
convolution process approach. Note that there are some ranges of
missing data for outputs one and four.</p>

<pre lang="octave"><code>&gt;&gt; demGpToy1
</code></pre>

<p></p><img src="Toy_predictionFTC2.png" width="50%"><img src="Toy_predictionFTC5.png" width="50%"><br> <i>Left</i> First output in the four outputs of the demo. <i>Right</i> Fourth output for the same example. 

<h3>
<a id="multi-output-gaussian-process-using-the-pitc-approximation-and-the-fitc-approximation-fixed-inducing-points" class="anchor" href="#multi-output-gaussian-process-using-the-pitc-approximation-and-the-fitc-approximation-fixed-inducing-points" aria-hidden="true"><span class="octicon octicon-link"></span></a>Multi-output Gaussian process using the PITC approximation and the FITC approximation (fixed inducing points)</h3>

<p>In the paper, two approximations that exploit conditional independencies in the model were proposed. Due to their similarities with the PITC and FITC approximations for the one output case, these multi-output approximations are named in a similar way. For PITC run</p>

<pre lang="octave"><code>&gt;&gt; demSpmgpGgToy1
</code></pre>

<p>For FITC run </p>

<pre lang="octave"><code>&gt;&gt; demSpmgpGgToy2
</code></pre>

<p></p><img src="toyPredictionPITC2.png" width="50%"><img src="toyPredictionPITC5.png" width="50%"><br> <img src="toyPredictionFITC2.png" width="50%"><img src="toyPredictionPITC5.png" width="50%"><br><i>Up</i> The same two outputs using PITC <i>Down</i> The same two outputs using FITC.

<h3>
<a id="multi-ouput-gaussian-processes-for-the-swiss-jura-dataset-only-pitc" class="anchor" href="#multi-ouput-gaussian-processes-for-the-swiss-jura-dataset-only-pitc" aria-hidden="true"><span class="octicon octicon-link"></span></a>Multi-ouput Gaussian processes for the Swiss Jura Dataset (only PITC)</h3>

<p>The experiment for the Swiss Jura Dataset using the full covariance
matrix can be recreated using ( you will need to obtain the files
prediction.dat and validation.dat from <a href="http://goovaerts.pierre.googlepages.com/">here</a>. Go to the Publications link and then to the Book link)</p>

<pre lang="octave"><code>&gt;&gt; demGgJura
</code></pre>

<p>The result with the approximation can be recreated using</p>

<pre lang="octave"><code>&gt;&gt; demSpmgpGgJura
</code></pre>

<p></p><img src="figureCd.png" width="50%"><img src="figureCu.png" width="50%">

<p>Mean absolute error and standard deviation for ten repetitions of the experiment for the Jura dataset In the bottom of each figure, IGP stands for independent GP, P(M) stands for PITC with M inducing values, FGP stands for full GP and CK stands for ordinary co-kriging. On the left, regression over Cadmium (Cd) and on the right, regression over Copper (Cu) </p>

<h3>
<a id="sparse-approximations-for-convolved-multiple-output-gaussian-processes" class="anchor" href="#sparse-approximations-for-convolved-multiple-output-gaussian-processes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sparse approximations for convolved multiple output Gaussian processes.</h3>

<p>We generate a toy dataset consisting of four outputs, one latent
function and one input dimension. The training data was sampled from
the full GP.  We generate 500 observation points for each output and
use 200 observation points (per output) for training the full and the
sparse multiple output GP.  The figure 2 shows the training
result. The predictions shown correspond to the full GP, the DTC
approximation, the FITC approximation and the PITC approximation. For
details of the setup refer to the paper. The difference with the previous toy example is that for this case we optimize the position of the inducing inputs.  </p>

<p>To run the full GP, use</p>

<pre lang="octave"><code>&gt;&gt; toy1DGgFTCExample
</code></pre>

<p>To run the DTC approximation, use</p>

<pre lang="octave"><code>&gt;&gt; toy1DGgDTCExample.m
</code></pre>

<p>To run the FITC approximation, use</p>

<pre lang="octave"><code>&gt;&gt; toy1DGgFITCExample.m
</code></pre>

<p>To run the PITC approximation, use</p>

<pre lang="octave"><code>&gt;&gt; toy1DGgPITCExample.m
</code></pre>

<p></p><img src="toy1DFTC4TrainTest.png" width="50%"><img src="toy1DDTC4TrainTest.png" width="50%"><br> <img src="toy1DFITC4TrainTest.png" width="50%"><img src="toy1DPITC4TrainTest.png" width="50%"><br><i>Up, Left</i> Output four using full GP. <i>Up, Right </i> Output four using the DTC approximation. <i> Output four using the FITC approximation. <i>Down, Right</i> Output four using the PITC approximation.  </i> 

<h3>
<a id="school-exam-score-prediction" class="anchor" href="#school-exam-score-prediction" aria-hidden="true"><span class="octicon octicon-link"></span></a>School exam score prediction.</h3>

<p>The goal is to predict the exam score obtained by a particular student
belonging to a particular school.  The data comes from the Inner
London Education Authority (ILEA) (this dataset can be obtained <a href="http://www.cmm.bristol.ac.uk/learning-training/multilevel-m-support/datasets.shtml">here</a>).</p>

<p>It consists of examination records from 139 secondary schools in years 1985, 1986 and 1987. It is a random 50% sample with 15362 students. From the multiple output point of view, each school represents one output and the exam score of each student a particular instantiation of that output.  The results in terms of percentage of explained variance are shown in the figure.  </p>

<p>To obtain the DTC approximation result, run</p>

<pre lang="octave"><code>&gt;&gt; schoolGgDTC
</code></pre>

<p>To obtain the FITC approximation result, run </p>

<pre lang="octave"><code>&gt;&gt; schoolGgFITC
</code></pre>

<p>To obtain the PITC approximation result, run</p>

<pre><code>&gt;&gt; schoolGgPITC.m
</code></pre>

<p></p><img src="figureSchool.png" width="70%"><br> Mean and
standard deviation of the percentage of explained variance for exam
score prediction results on the ILEA dataset. The experiment was
repeated ten times. In the bottom of the figure DK, FK, PK stands for
DTC, FITC and PITC with K inducing values, respectively, ICM stands
for intrinsic coregionalization model and IND stands for independent
GPs. The ICM and the independent GPs results were obtained from
Bonilla et al. (2008).  

<h3>
<a id="cell-cycle-of-yeast" class="anchor" href="#cell-cycle-of-yeast" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cell cycle of Yeast.</h3>

<p>The dataset can be obtained <a href="http://www.cs.manchester.ac.uk/~neill/chipvar/">here</a>. It
contains the expression level for 24 time points of 1935 genes. The
connectivity matrix is also provided. We use the SIM kernel to infer
the activity of the transcription factor ACE2 and the transcription
factor SWI5. Figure shows the shape of the inferred
transcriptions. The PITC approximation is employed with 15 inducing
inputs.</p>

<p>To train the model that allows to infer the transcription factor
proteins in the figure, run</p>

<pre lang="octave"><code>&gt;&gt; demSpmgpSimYeastSpellmanPitc
</code></pre>

<p></p><img src="yeastSpellmanPITC2GeneExpression.png" width="50%"><img src="yeastSpellmanPITC2.png" width="50%"><br> <img src="yeastSpellmanPITC93GeneExpression.png" width="50%"><img src="yeastSpellmanPITC93.png" width="50%">

<p>Gene expresion profile and inferred protein concentration for ACE2 and
SWI5. The first column shows the gene expression level. The second
column shows the mean posterior over the transcription factor and two
standard deviations for the uncertainty.  <i>Up, Left</i> Gene
expression profile for ACE2. <i>Up, Right </i> Inferred protein
concentration for ACE2.  <i>Down, Left</i> Gene expression profile for
SWI5. <i>Down, Right</i> Inferred protein concentration for SWI5.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/SheffieldML/multigp">multigp</a> is maintained by <a href="https://github.com/SheffieldML">SheffieldML</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-62971049-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
